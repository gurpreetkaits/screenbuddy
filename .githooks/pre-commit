#!/bin/bash

# Get list of staged PHP files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.php$')

if [ -z "$STAGED_FILES" ]; then
    exit 0
fi

echo "Running Laravel Pint on staged files..."

# Run Pint on staged files only
./vendor/bin/pint $STAGED_FILES

# Check if Pint made any changes
CHANGED_FILES=$(git diff --name-only $STAGED_FILES)

if [ -n "$CHANGED_FILES" ]; then
    echo ""
    echo "Pint has fixed formatting issues. Adding changes..."
    git add $CHANGED_FILES
    echo "Done! Formatted files have been added to your commit."
fi

exit 0
